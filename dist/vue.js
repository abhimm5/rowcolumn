"use strict";var I=Object.defineProperty;var H=Object.getOwnPropertyDescriptor;var V=Object.getOwnPropertyNames;var U=Object.prototype.hasOwnProperty;var B=(e,t)=>{for(var n in t)I(e,n,{get:t[n],enumerable:!0})},q=(e,t,n,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of V(t))!U.call(e,i)&&i!==n&&I(e,i,{get:()=>t[i],enumerable:!(s=H(t,i))||s.enumerable});return e};var F=e=>q(I({},"__esModule",{value:!0}),e);var X={};B(X,{Layout:()=>G});module.exports=F(X);var m=require("vue");function Z(e){return{t:e.top||0,r:e.right||0,b:e.bottom||0,l:e.left||0}}function z(e,t,n){if(e instanceof L||typeof e!="object"||e===null)return e;let s=e,i=Object.keys(s).sort((o,d)=>(n[d]||0)-(n[o]||0));for(let o of i)if(t>=(n[o]||0))return s[o];return s.xs??s.default??1}function $(e,t){if(!t)return;let{className:n,class:s,...i}=t;n&&e.classList.add(...String(n).split(" ")),s&&e.classList.add(...String(s).split(" ")),Object.assign(e.style,i)}var L=class e{constructor(t,n="leaf",s=[]){this.size=t;this.type=n;this.children=s;this.isSkippedSelf=!1;this.offsetIndices=[];this.styles={};this.spanData={t:0,r:0,b:0,l:0};this.childPropRules=[];this.childSpanRules=[]}col(...t){return new e(this.size,"col",t)}row(...t){return new e(this.size,"row",t)}offset(t){return Array.isArray(t)?this.offsetIndices=t:this.isSkippedSelf=!0,this}props(t){return this.styles={...this.styles,...t},this}childProps(t,n){return this.childPropRules.push({data:t,indices:n||null}),this}span(t,n){let s=Z(t);return n?this.childSpanRules.push({data:s,indices:n}):(this.spanData.t+=s.t,this.spanData.r+=s.r,this.spanData.b+=s.b,this.spanData.l+=s.l),this}},A=class{constructor(t,n,s,i,o,d,g,b={t:0,r:0,b:0,l:0}){this.x=t;this.y=n;this.w=s;this.h=i;this.styles=o;this.isSkipped=d;this.customSize=g;this.spanData=b}},P=!1;function O(){if(P)return;P=!0;let e=(t,n=!1)=>{if(t.col)return;let s=i=>new L(n?String(i):i);t.col=function(...i){return new L(n?String(this):this,"col",i)},t.row=function(...i){return new L(n?String(this):this,"row",i)},t.offset=function(i){return s(this).offset(i)},t.props=function(i){return s(this).props(i)},t.childProps=function(i,o){return s(this).childProps(i,o)},t.span=function(i,o){return s(this).span(i,o)}};e(Number.prototype,!1),e(String.prototype,!0)}var _={bps:{xs:0,sm:576,md:768,lg:992,xl:1200,xxl:1400},_strMap:new Map,_strCounter:0,init(){O(),this.upd(),typeof window<"u"&&window.addEventListener("resize",()=>this.upd())},upd(){typeof document<"u"&&document.querySelectorAll("[layout]").forEach(e=>this.render(e))},evalLayout(e){if(e)try{return new Function("lg","sm","Grid","auto","none","return "+e)(61.8,38.2,100,"auto","none")}catch{return}},isNode(e){return e&&typeof e=="object"&&Array.isArray(e.children)},render(e,t){O();let n=typeof window<"u"?window.innerWidth:0,s=t;if(!s){let a=n>=1400&&e.getAttribute("layout-xxl")||n>=1200&&e.getAttribute("layout-xl")||n>=992&&e.getAttribute("layout-lg")||n>=768&&e.getAttribute("layout-md")||n>=576&&e.getAttribute("layout-sm")||e.getAttribute("layout");a&&(s=this.evalLayout(a))}if(!s)return;$(e,s.styles);let i=[];this.calc(s,0,0,100,100,i,!1,[],[],[],{val:0},n,{t:0,r:0,b:0,l:0});let{cw:o,rh:d,xc:g,yc:b}=this.mesh(i);e.style.display="grid",e.style.gridTemplateColumns=o.join(" "),e.style.gridTemplateRows=d.join(" ");let p=Array.from(e.children);p.forEach(a=>{a.style.gridArea="",a.style.display=""});let u=0;i.forEach(a=>{if(a.isSkipped)return;let f=p[u++];if(!f)return;if(a.styles?.display==="none"){f.style.display="none";return}let h=this.idx(g,a.x)+1,r=this.idx(g,a.x+a.w)+1,x=this.idx(b,a.y)+1,w=this.idx(b,a.y+a.h)+1;a.spanData&&(h=Math.max(1,h-a.spanData.l),x=Math.max(1,x-a.spanData.t),r+=a.spanData.r,w+=a.spanData.b),f.style.gridColumn=`${h} / ${r}`,f.style.gridRow=`${x} / ${w}`,$(f,a.styles)})},calc(e,t,n,s,i,o,d,g,b,p,u,a,f){if(e==null)return;let h=z(e,a,this.bps),r;this.isNode(h)?(r=h,r.size=z(r.size,a,this.bps)):r=new L(h,"leaf");let x=this.isNode(r),w=d||r.isSkippedSelf,D=[...g];x&&r.offsetIndices?.length&&D.push({idx:r.offsetIndices,c:0});let N={...f};x&&(N.t+=r.spanData.t,N.r+=r.spanData.r,N.b+=r.spanData.b,N.l+=r.spanData.l);let M=[...b],R=[...p];if(r.childPropRules.length&&r.childPropRules.forEach(l=>M.push({rule:l,counter:{val:0}})),r.childSpanRules.length&&r.childSpanRules.forEach(l=>R.push({rule:l,counter:{val:0}})),r.type==="leaf"||!r.children.length){let l=w;D.forEach(c=>{c.c++,c.idx.includes(c.c)&&(l=!0)}),l||(u.val++,M.forEach(c=>c.counter.val++),R.forEach(c=>c.counter.val++));let y={...N};l||R.forEach(c=>{(!c.rule.indices||c.rule.indices.includes(c.counter.val))&&(y.t+=c.rule.data.t,y.r+=c.rule.data.r,y.b+=c.rule.data.b,y.l+=c.rule.data.l)});let S={...r.styles};r.size==="none"&&(S.display="none"),l||M.forEach(c=>{(!c.rule.indices||c.rule.indices.includes(c.counter.val))&&Object.assign(S,c.rule.data)}),o.push(new A(t,n,s,i,S,l,typeof r.size=="string"?r.size:void 0,y));return}let v=0,j=r.children.map(l=>{let y=z(l,a,this.bps);return this.isNode(y)&&(y.size=z(y.size,a,this.bps)),y});j.forEach(l=>{let y=this.isNode(l)?l.size:l;y==="none"||typeof y=="string"?y=0:this.isNode(l)&&l.size===0&&(y=1),v+=Number(y)}),v===0&&(v=1);let E=r.type==="col"?t:n;j.forEach(l=>{let y=this.isNode(l)?l.size:l,S=typeof y=="string",c=S?0:Number(y);this.isNode(l)&&l.size===0&&!S&&(c=1);let C=c/v,k=0;if(S&&y!=="none"&&(this._strCounter++,k=1e-6+this._strCounter*1e-7,this._strMap.set(k.toFixed(9),y)),r.type==="col"){let T=S?k:s*C;this.calc(l,E,n,T,i,o,w,D,M,R,u,a,{t:0,r:0,b:0,l:0}),E+=T}else{let T=S?k:i*C;this.calc(l,t,E,s,T,o,w,D,M,R,u,a,{t:0,r:0,b:0,l:0}),E+=T}})},mesh(e){this._strCounter=0;let t=[0],n=[0],s=0,i=0;e.forEach(p=>{t.push(p.x,p.x+p.w),n.push(p.y,p.y+p.h),s=Math.max(s,p.x+p.w),i=Math.max(i,p.y+p.h)}),s>1&&t.push(100),i>1&&n.push(100);let o=p=>[...new Set(p.sort((u,a)=>u-a))].filter((u,a,f)=>a===0||Math.abs(u-f[a-1])>1e-8),d=o(t),g=o(n),b=p=>{let u=[];for(let a=1;a<p.length;a++){let f=p[a]-p[a-1],h=null;for(let[r,x]of this._strMap)if(Math.abs(f-Number(r))<1e-8){h=x;break}u.push(h||f/10+"fr")}return u};return{xc:d,yc:g,cw:b(d),rh:b(g)}},idx(e,t){let n=-1,s=1/0;return e.forEach((i,o)=>{let d=Math.abs(i-t);d<s&&(s=d,n=o)}),n},compileCSS(e){let t=this.evalLayout(e);if(!t)return null;let n=[];this.calc(t,0,0,100,100,n,!1,[],[],[],{val:0},1200,{t:0,r:0,b:0,l:0});let{cw:s,rh:i,xc:o,yc:d}=this.mesh(n),g=`display: grid; grid-template-columns: ${s.join(" ")}; grid-template-rows: ${i.join(" ")};`,b="",p=1;for(let u of n){if(u.isSkipped)continue;let a=this.idx(o,u.x)+1,f=this.idx(o,u.x+u.w)+1,h=this.idx(d,u.y)+1,r=this.idx(d,u.y+u.h)+1;u.spanData&&(a=Math.max(1,a-u.spanData.l),h=Math.max(1,h-u.spanData.t),f+=u.spanData.r,r+=u.spanData.b),b+=`
  & > :nth-child(${p++}) { grid-area: ${h} / ${a} / ${r} / ${f};${u.styles?.display==="none"?" display: none;":""} }`}return g+b}};var G=(0,m.defineComponent)({name:"Layout",props:{layout:{type:[String,Object],required:!0},"layout-sm":{type:[String,Object]},"layout-md":{type:[String,Object]},"layout-lg":{type:[String,Object]}},setup(e,{slots:t,attrs:n}){let s=(0,m.ref)(null),i=()=>{if(s.value){let o=window.innerWidth,d;o>=992&&typeof e["layout-lg"]=="object"?d=e["layout-lg"]:o>=768&&typeof e["layout-md"]=="object"?d=e["layout-md"]:o>=576&&typeof e["layout-sm"]=="object"?d=e["layout-sm"]:typeof e.layout=="object"&&(d=e.layout),_.render(s.value,d)}};return(0,m.onMounted)(()=>{i(),window.addEventListener("resize",i)}),(0,m.onUpdated)(()=>i()),(0,m.onUnmounted)(()=>window.removeEventListener("resize",i)),()=>{let o={...n};return typeof e.layout=="string"&&(o.layout=e.layout),typeof e["layout-sm"]=="string"&&(o["layout-sm"]=e["layout-sm"]),(0,m.h)("div",{ref:s,style:{display:"grid",width:"100%",height:"100%"},...o},t.default?t.default():[])}}});0&&(module.exports={Layout});
