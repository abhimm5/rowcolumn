"use strict";var v=Object.defineProperty;var k=Object.getOwnPropertyDescriptor;var I=Object.getOwnPropertyNames;var C=Object.prototype.hasOwnProperty;var j=(e,t)=>{for(var i in t)v(e,i,{get:t[i],enumerable:!0})},_=(e,t,i,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let u of I(t))!C.call(e,u)&&u!==i&&v(e,u,{get:()=>t[u],enumerable:!(r=k(t,u))||r.enumerable});return e};var O=e=>_(v({},"__esModule",{value:!0}),e);var U={};j(U,{Engine:()=>T,Grid:()=>H,LayoutNode:()=>w,Rect:()=>M,auto:()=>G,installExtensions:()=>D,lg:()=>W,sm:()=>F});module.exports=O(U);function P(e){let t={t:0,r:0,b:0,l:0};return e.forEach(i=>{let r=i.match(/^([trbl])(\d+)$/);r&&(t[r[1]]+=parseInt(r[2],10))}),t}var w=class e{constructor(t,i="leaf",r=[]){this.size=t;this.type=i;this.children=r;this.isSkippedSelf=!1;this.offsetIndices=[];this.styles={};this.spreadData={t:0,r:0,b:0,l:0};this.childPropRules=[];this.childSpreadRules=[]}col(...t){return new e(this.size,"col",t)}row(...t){return new e(this.size,"row",t)}offset(t){return Array.isArray(t)?this.offsetIndices=t:this.isSkippedSelf=!0,this}props(t){return this.styles={...this.styles,...t},this}childProps(t,i){return this.childPropRules.push({data:t,indices:i||null}),this}spread(t,i){let r=P(t);return i?this.childSpreadRules.push({data:r,indices:i}):(this.spreadData.t+=r.t,this.spreadData.r+=r.r,this.spreadData.b+=r.b,this.spreadData.l+=r.l),this}},M=class{constructor(t,i,r,u,n,f,m,y={t:0,r:0,b:0,l:0}){this.x=t;this.y=i;this.w=r;this.h=u;this.styles=n;this.isSkipped=f;this.customSize=m;this.spreadData=y}},A=!1;function D(){if(A)return;A=!0;let e=i=>new w(i),t=(i,r=!1)=>{if(i.col)return;let u=n=>e(r?String(n):n);i.col=function(...n){return new w(r?String(this):this,"col",n)},i.row=function(...n){return new w(r?String(this):this,"row",n)},i.offset=function(n){return u(this).offset(n)},i.props=function(n){return u(this).props(n)},i.childProps=function(n,f){return u(this).childProps(n,f)},i.spread=function(n,f){return u(this).spread(n,f)}};t(Number.prototype,!1),t(String.prototype,!0)}var T={bps:{sm:576,md:768,lg:992,xl:1200,xxl:1400},_strMap:new Map,_strCounter:0,init(){D(),this.upd(),typeof window<"u"&&window.addEventListener("resize",()=>this.upd())},upd(){typeof document<"u"&&document.querySelectorAll("[layout]").forEach(e=>this.render(e))},evalLayout(e){if(e)try{return new Function("lg","sm","Grid","auto","return "+e)(61.8,38.2,100,"auto")}catch(t){console.error(`Layout Error: "${e}"`,t);return}},isNode(e){return e&&typeof e=="object"&&Array.isArray(e.children)&&(e.type==="col"||e.type==="row"||e.type==="leaf")},render(e,t){D();let i=t;if(!i){let s=window.innerWidth,a=["xxl","xl","lg","md","sm"],p=e.getAttribute("layout");for(let d of a)if(s>=this.bps[d]&&e.hasAttribute(`layout-${d}`)){p=e.getAttribute(`layout-${d}`);break}p&&(i=this.evalLayout(p))}if(!i)return;if(i.styles){let{className:s,class:a,...p}=i.styles;s&&e.classList.add(...s.split(" ")),a&&e.classList.add(...a.split(" ")),Object.assign(e.style,p)}let r=[];this.calc(i,0,0,100,100,r,!1,[],[],[],{val:0});let{cw:u,rh:n,xc:f,yc:m}=this.mesh(r);e.style.display="grid",e.style.gridTemplateColumns=u.join(" "),e.style.gridTemplateRows=n.join(" ");let y=Array.from(e.children);y.forEach((s,a)=>{s.style.gridColumn="",s.style.gridRow="",s.style.cssText=""});let o=0;r.forEach(s=>{if(s.isSkipped||!y[o])return;let a=y[o++],p=this.idx(f,s.x)+1,d=this.idx(f,s.x+s.w)+1,h=this.idx(m,s.y)+1,g=this.idx(m,s.y+s.h)+1;if(s.spreadData&&(p=Math.max(1,p-s.spreadData.l),h=Math.max(1,h-s.spreadData.t),d+=s.spreadData.r,g+=s.spreadData.b),a.style.gridColumn=`${p} / ${d}`,a.style.gridRow=`${h} / ${g}`,s.styles){let{className:x,class:S,...N}=s.styles;x&&a.classList.add(...x.split(" ")),S&&a.classList.add(...S.split(" ")),Object.assign(a.style,N)}})},calc(e,t,i,r,u,n,f,m,y,o,s){if(!e)return;(typeof e=="number"||e==="auto")&&(e=new w(e==="auto"?"auto":e,"leaf"));let a=this.isNode(e),p=f||a&&e.isSkippedSelf,d=[...m],h=[...y],g=[...o];a&&(e.offsetIndices?.length&&d.push({idx:e.offsetIndices,c:0}),e.childPropRules.length&&e.childPropRules.forEach(c=>h.push({rule:c,counter:{val:0}})),e.childSpreadRules.length&&e.childSpreadRules.forEach(c=>g.push({rule:c,counter:{val:0}})));let x;if(a&&typeof e.size=="string"&&(x=e.size),!a||!e.children.length){let c=p;for(let l=0;l<d.length;l++)d[l].c++,d[l].idx.includes(d[l].c)&&(c=!0);c||(s.val++,h.forEach(l=>l.counter.val++),g.forEach(l=>l.counter.val++));let b=a?{...e.spreadData}:{t:0,r:0,b:0,l:0},L=a?{...e.styles}:{};c||(g.forEach(l=>{(!l.rule.indices||l.rule.indices.includes(l.counter.val))&&(b.t+=l.rule.data.t,b.r+=l.rule.data.r,b.b+=l.rule.data.b,b.l+=l.rule.data.l)}),h.forEach(l=>{(!l.rule.indices||l.rule.indices.includes(l.counter.val))&&Object.assign(L,l.rule.data)})),n.push(new M(t,i,r,u,L,c,x,b));return}let S=0;e.children.forEach(c=>{let b=this.isNode(c)?c.size:c;typeof b=="string"?b=0:this.isNode(c)&&c.size===0&&(b=1),S+=Number(b)}),S===0&&(S=1);let N=e.type==="col"?t:i;e.children.forEach((c,b)=>{let L=this.isNode(c)?c.size:c,l=typeof L=="string",$=l?0:Number(L);this.isNode(c)&&c.size===0&&!l&&($=1);let z=$/S,R=0;if(l&&(this._strCounter++,R=1e-6+this._strCounter*1e-7,this._strMap.set(R.toFixed(9),L)),e.type==="col"){let E=l?R:r*z;this.calc(c,N,i,E,u,n,p,d,h,g,s),N+=E}else{let E=l?R:u*z;this.calc(c,t,N,r,E,n,p,d,h,g,s),N+=E}})},mesh(e){this._strCounter=0;let t=[0],i=[0],r=0,u=0;e.forEach(o=>{t.push(o.x,o.x+o.w),i.push(o.y,o.y+o.h),o.x+o.w>r&&(r=o.x+o.w),o.y+o.h>u&&(u=o.y+o.h)}),r>1&&t.push(100),u>1&&i.push(100);let n=o=>[...new Set(o.sort((s,a)=>s-a))].filter((s,a,p)=>a===0||Math.abs(s-p[a-1])>1e-8),f=n(t),m=n(i),y=o=>{let s=[];for(let a=1;a<o.length;a++){let p=o[a]-o[a-1],d=null;for(let[h,g]of this._strMap){let x=Number(h);if(Math.abs(p-x)<1e-8){d=g;break}}s.push(d||p+"fr")}return s};return{xc:f,yc:m,cw:y(f),rh:y(m)}},idx(e,t){let i=-1,r=1/0;return e.forEach((u,n)=>{let f=Math.abs(u-t);f<r&&(r=f,i=n)}),i},compileCSS(e){let t=this.evalLayout(e);if(!t)return null;let i=[];this.calc(t,0,0,100,100,i,!1,[],[],[],{val:0});let{cw:r,rh:u,xc:n,yc:f}=this.mesh(i),m=`display: grid; grid-template-columns: ${r.join(" ")}; grid-template-rows: ${u.join(" ")};`,y="",o=1;for(let s of i){if(s.isSkipped)continue;let a=this.idx(n,s.x)+1,p=this.idx(n,s.x+s.w)+1,d=this.idx(f,s.y)+1,h=this.idx(f,s.y+s.h)+1;s.spreadData&&(a=Math.max(1,a-s.spreadData.l),d=Math.max(1,d-s.spreadData.t),p+=s.spreadData.r,h+=s.spreadData.b),y+=`
  & > :nth-child(${o++}) { grid-area: ${d} / ${a} / ${h} / ${p}; }`}return m+y}};var H=100,W=61.8,F=38.2,G="auto";typeof window<"u"&&D();0&&(module.exports={Engine,Grid,LayoutNode,Rect,auto,installExtensions,lg,sm});
